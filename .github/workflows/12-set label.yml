name: Label Issues (Permissions Example)
on:
  issues:
    types:
      - opened
#    push:
#        branches:
#         - main

# permissions: - can set permission on workflow level
# to see all the allowed permission -
# https://docs.github.com/en/actions/using-jobs/assigning-permissions-to-jobs

jobs:
  assign_label:
  permissions: # read-all / write-all - all the permissions in github list like actions, checks, contents, deployments, id-token, issues
    # depending on permission we set here, it will reflect in secrets.GITHUB_TOKEN scope of available actions
    issues: write # need write access, the other permissions are not granted by default if we set any permission here
    runs-on: macos-latest
    steps:
        - name: Assing Label
          if: contains(github.event.issue.title, 'bug')
          run: |
            curl -X POST \
            --url https://api.github.com/repos/${{ github.repository }}/issues/${{ github.event.issue.number }}/labels \
            -H 'authorization: Bearer ${{ secrets.GITHUB_TOKEN }}' \
            -H 'content-type: application/json' \
            -d '{
                "labels": ["bug"]
            }' \
            --fail
